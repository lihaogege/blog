---
title: '浏览器工作原理'
date: '2022-8/15 17:56'
excerpt: 浏览器得发展史,了解浏览器的工作原理的必要性,浏览器的简介,SEO(搜索引擎优化)
isFeatured: true
image:
---

## 浏览器工作原理	

> 作为Web全栈工程师,主要就是依托于浏览器进行项目得开发,所以对于浏览器得工作以及发展得了解有助于我们开发出更加流畅,更加适合浏览器运作得项目

## 浏览器得发展史

- 1991年8月,brners.Lee发明了WoridWideWeb万维网,并且随之诞生了第一个浏览器

  > 这个浏览器主要用于文档得沟通,这款浏览器只能放置一些文字内容

- 1993年,伊利诺大学得NCSE发明了第一款能够显示图片得浏览器"Mosaic",马赛克

  > 这款浏览器可以用于展示图片,图文结合,更加完善得一种浏览器

  **因为市面上流单行两种浏览器,一种是支持图片展示,另一种不支持,那么如何判断用户使用得浏览器来决定是否显示图片呢,'?用户代理(UserAgent)由此诞生**

  > 用户代理(UserAgent)可以分用户使用得浏览器,系统,根据他们得不同让服务器返回不同的内容,是否携带图片等

- Mozilla的诞生对当时的浏览器但因为名字太具有侵略性,考虑到市场原因,改名为Nerscape Navigator(网景航海家)

- 1995年,微软发布了于微软绑定的浏览器Internet Explorer(互联网探险家)简称IE

- 1995年同期,挪威的一家公司推出了Opera(歌剧)浏览器,为后续的标签式浏览器的发展奠定了基础

- 1998年1月,网景为了挽回一切,宣布旗下的软件都免费,改名火狐

- 2008年谷歌浏览器诞生,迅速占据市场

## 了解浏览器的工作原理的必要性

- 能够准确评估Web项目的可行性

- 能够从更高的维度审查页面

- 在快速的技术迭代中把握本质

  > 我们掌握了原理,掌握了本质,能够非常快速的去适应并学习新的技术



### 浏览器的工作原理

1. 向网络请求HTML文档内容
2. 接收到文档内容后,浏览器的渲染引擎开始工作
3. 解析HTML文档,将文档中的标签转换为DOM节点树,即"内容树"同时解析外部的css文件和style标签内的样式
4. 解析出来的信息连同页面中的可见内容将被一起用于构建渲染树
5. 渲染树(render)是由一些带有视觉属性的矩形组成,这些矩形按照正确的顺序展示到屏幕中
6. 渲染树构建完成后,进入到布局处理阶段,将每一个放好的矩形(节点)分配一个屏幕坐标
7. 最后遍历渲染树,通过UI后端3
8. 层绘制每一个节点,到此我们才能看到一个完整的页面.

## 浏览器的简介

#### 浏览器的组成部分

- 用户界面:包括地址栏,前进后退按钮,书签等
- 浏览器引擎:在用户界面和渲染引擎直接传送指令
- 渲染引擎:解析HTML,CSS,并将他们显示到屏幕中
- 网络:用户网络调用
- 用户界面后端:绘制基本的窗口小部件,比如组合框和窗口
- js引擎:用于解析js代码
- 数据存储:浏览器需要在硬盘中保存各种数据,比如说cookie

#### 浏览器的内核

> 浏览器的内核有两部分组成,分为渲染引擎和js引擎

**随着js引擎的发展,它越来越独立,现在我们所说我浏览器内核一般指的就是渲染引擎**

- **渲染引擎**

  > 各大浏览器的渲染引擎

  - 2013年开始.Chrome浏览器和Opera浏览器开始使用Blink内核
  - FireFox使用gecko引擎
  - IE使用Trident引擎
  - 2015年微软推出自己新浏览器原名叫斯巴达,后改名edge,使用edge引擎
  - safiri使用webkit引擎

- **js引擎**

  - 老版本IE使用jsscript引擎
  - IE9之后使用Chakra引擎
  - edge浏览器仍旧使用Charkra引擎
  - fireFox使用monkey系列引擎
  - safari使用的SquirreIFish引擎
  - Opear使用carakan引擎
  - chrome使用V8引擎,而nodejs其实就是封装了V8引擎

### 浏览器的兼容性

> 兼容性指的是:不同的浏览器,对同一段代码有不同的解析,导致页面效果显示不同意的情况,理论上我们需要无论用户使用的是什么浏览器,看到的网页都因该一样的,这是我们前端开发人员经常会遇到并解决的问题

### 浏览器兼容性处理的原则

- 优雅降级

  > 先实现最佳的用户体验的页面效果,然后再去适应到新版本的浏览器中,适应过程中会有一些效果被取消或降低

- 渐进增强

  > 先将我们的网页完美的适应到低版本的浏览器中,再去添加一些相应的内容去改善页面的效果,提高网页的用户体验.

### 如何处理兼容问题

- 确定兼容性的触发场景
- 找到问题产生的原因
- 确定解决方法
- 积累兼容性的处理方法

### PC端常见的兼容性问题

- 不同浏览器的标签默认样式不统一

- img标签底部会出现间隙

  > div中包含一张图片,底部可能有2px 4px或更多的间隙,不同font-size:会影响这个间隙的大小.
  >
  > - 将图片的垂直方式vertival-align改成top或者bottom
  > - 将img转为块标签  display:block;
  > - 将包含图片的父元素的字体大小设置为0

- img标签在IE浏览器下有边框

  > 清除边框:border:none;

- 兼容IE9要注意的一些问题

  - 在HTML中引入css文件时,需要添加类型 type="text/css"
  - IE9及以下不支持弹性布局,网格布局
  - 动画,渐变,文字阴影等属性在IE6-IE9都不支持
  - transition和border-image属性在IE6-IE10都不支持
  - 2d转换属性在IE6-IE8不支持,在IE9需要添加前缀
  - HTML标签不支持IE9以下的版本,main标签在IE9-IE11不支持
  - calc计算属性在IE9部分支持,IE6-IE8不支持

- 兼容IE8要注意的问题

  1. 在IE8中加入了"兼容性试图"功能,所以会使用IE6或IE7的内核渲染页面,我们可以使用meta强制设置使用最新的内核渲染页面

  ```javascript
  <meta http-equiv="x-UA-Compatible" content="edgr,chorme=1"/>
  ```

  1. box-shadow,border-radius属性在ie6-8都不支持
  2. IE8不支持:last-child
  3. IE8不支持 background-size:cover 

### HTML5新标签的兼容性

> 低版本无法识别H5中一些语义化标签,我们可以通过JS生成这些标签,同时通过css设置这些标签的属性为display:block;转换成块标签

- 自主解决

  ```javascript
  let arr = ['header','footer','nav','section'.'article'];
  arr.forEach(function (v) {
              doucument.createElement(v);
              });
  ```

  ```css
  header,fonoter,nav,section,article,aside {
      display-block;
  }
  ```

- 使用封装库解决兼容性问题

## 移动端兼容性

- 移动端开发需要加入的代码

  ```
  <meta http-equiv='content-type' content='text/html;charset=UTF-5'/>
   <meta name="viewport" content="width=device-width,
  ```

- 在移动端上传图片,使用accept="images/*", multiple解决低端机的兼容问题

  ```javascript
  <input type="file" accept="image/*" multiple />
  ```

- input具有placeholder的时候不要设置行高,否则会偏上

- 忽略将页面中的数字识别成电话号码

  > safari会将页面中的数字识别成电话号码,颜色会变成蓝色,同时会弹出保存电话号码的弹框
  >
  > 使用safari私有属性进行设置

  ```javascript
  <meta name="format-detection" content="telephone=no" />
  ```

- webkit表单默认外观重置

  ```css
  .选择器{
      -webkit-appearance:none;
  }
  ```

- 当input框在获取焦点时文字清空使用value值,如果在输入文本时清空文字使用placeholder

- 禁用radio和checkbox的默认样式

  ```css
  input[type="radio"]::-ms-check,input[type="checkbox"]::-ms-check {
      display:none;
  }
  /*设置完成后就可以使用我们自己定义的单选按钮和多选按钮的样式*/
  ```

- <buttom>元素一定要设置type类型否则会默认提交表单,出现严重的bug

- ios和android下触摸元素会出现半透明的灰色遮罩

  ```css
  选择器 {
  -webkit-tap-highlight-color:rgba(255,255,255,0)
  }
  ```

- 旋转屏幕时，字体大小调整的问题

  ```css
  html, body, form, fieldset, p, div, h1, h2, h3, h4, h5, h6{
  -webkit-text-size-adjust:100%;
  }
  ```

- 通过transform进行skew变形，rotate旋转会造成出现锯齿现象

  ```css
  .选择器{
  -webkit-transform: rotate(-4deg) skew(10deg) translateZ(0);
  transform: rotate(-4deg) skew(10deg) translateZ(0);
  outline: 1px solid rgba(255,255,255,0)
  }
  ```

- html5调用安卓或者ios的拨号功能

  > html5提供了自动调用拨号的标签，只要在a标签的href中添加tel:就可以了。

  ```css
  <a href="tel: 1519198151 ">点击拨打1519198151</a>
  <a href="tel: 1519198151,412">点击拨打1519198151 转 412</a>
  ```

- 长时间按住页面出现闪退

  ```css
  选择器{
      -webkit-touch-callout:none;
  }
  ```

- calc计算属性的兼容性处理:在IOS浏览器中需要添加-webkit-前缀,在火狐浏览器中不需要加-moz-前缀



## Web性能优化

> 当我们在浏览网页时期待的是尽快能够加载出来网页的内容,如果等待时间过长,用户体验就会变差,所以性能优化势在必行

- 从用户角度出发,性能优化可以改善用户的体验
- 从服务商角度出发,性能优化可以有效的节省宽带,节省一部分资源

### 性能优化的方向

**减少网页的http请求**

> 能够触发http请求的网页内容:html文件,图片,视频.音频.css文件,js文件

- 合并文件,减少页面文件的引用

  > 建议将多个css以及js脚本文件合并成一个,减少页面文件的下载次数

- 合并图标

  - 图片精灵技术

    > 将一些常用的小图标集体放置在一个图片中,通过背景图片进行引入,一个图片可以多次利用

  - 使用iconfont字体图标代替图标,但是字体图标只支持同色

  - 使用base64技术,将一些小图片转换成base64格式

    > base64的图片在任何平台下都可以进行访问,类似于保存在本地,减少了http请求

**减少网页的内容**

- 减少页面中无用的元素

- 压缩JS和css.将其中无意义的空格全都去掉

- 内容优化

  > 网页中的内容多少我们无法决定,但是可以通过布局手段优化加载速度,尽量减少DOM元素的层数

- 合理的图片格式

| 类别         | 结果            |
| ------------ | --------------- |
| 大小比较     | PNG ≈ JPG > GIF |
| 透明性       | PNG > GIF > JPG |
| 色彩丰富程度 | JPG > PNG >GIF  |
| 兼容程度     | GIF ≈ JPG > PNG |

- 合理的图片大小

  > 如果图片不经过处理.图片文件会非常大,导致网页加载速度过慢

  - 对图片进行压缩
    1. 使用ps进行图片压缩
    2. 在线工具压缩
    3. 本地工具压缩(智图)

### 其他优化思想

- 利用缓存技术
- 恰当防止css的位置,在head中引入css文件
- 使用外部的css,外部的css可以保存在本地中,只需要加载一次既可
- 语义化html标签的使用
- 优化css性能
  - 不要使用@import 指令 来引入外部样式表。这是一个过时的方法，它会阻止浏览并行下载。link 标签才是最好的选择，它也能提高网站的前端性能
  - 浏览器时从右向左匹配选择符的，所以我们把权重大的选择器放在后面
  - 尽量避免后代选择器 （通常后代选择器是开销最高的，如果可以，请使用子选择器代替。）
  - 依靠继承,合并相同的类
  - 属性缩写
  - 减少查询层级和减少查询范围
  - 避免使用 CSS Filter（CSS滤镜）
  - 不要使用通配符
  - 避免使用后代选择器,少用子选择器

## SEO(搜索引擎优化)

> SEO: Search Engine Optimization 搜索引擎优化,利用搜索引擎的规则提高我们网站在相关搜索引擎内的自然排名,提高网站的知名度

### 站内优化

- meta标签优化
- 站内链接优化
- 网站内容更新

#### 站内优化的具体方法

> 在项目开发中主要还是进行站内优化

- 网站URL

  1. 尽量不要在url中放置session id,统计代码等不必要的内容
  2. 减少网页内的无用的链接
  3. 错误的url需要跳转到404页面
  4. 尽量使用伪静态或者静态作为url链接,提高搜索引擎的友好度

- title信息

  > 搜索引擎在判断一个网站的权重时,title是一个重要的判断信息,title主要是用于介绍网站的内容

  - title中要包含:
    1. 首页:包含网站信息
    2. 频道页:频道名称+网页名称
    3. 文章页:文章title+频道名称+网站名称

- meta信息

  - 网站的简介

  ```html
  <meta name="description" content="网站的描述" />
  <meta name="keywords" content="关键词1,关键词2" />
  ```

- 增加关键词密度
- 代码优化
- 路径优化
- 网站地图的设计
- 网站内容更新
- img的alt属性
- 减少iframe框架的使用



### 站外优化

- 添加一些外部链接:友情链接,微博,论坛等
- 外部链接的运营:添加一些一定数量的外部链接,使关键词的排名稳步提升
- 外链选择:与一些跟我们网站相关的网站交换友情链接,巩固提高关键词的排名